/*
 *  list-picker - v1.0.0
 *  A JavaScript library that creates lists you can pick and switch items between them and return picks
 *
 *  Made by:
 *    • Fábio Moraes Rosa - fabiomrosa@gmail.com
 *    • Rogério Banquieri - rogerio@banquieri.com
 * 
 *  Under MIT License
 *  http://www.opensource.org/licenses/mit-license.php
 * 
 *  Copyright (c) 2017
 */
// the semi-colon before function invocation is a safety net against concatenated
!function(t,s,e){"use strict";function i(t,s){this._identity=t,this._settings=s,this._init(),this._mount()}i.prototype.getPicks=function(){for(var t=0;t<this._elements.lists.length;t++){this._controls.lists.list=[];for(var s=0;s<this._elements.lists[t].childNodes.length;s++)this._controls.lists.list.push(this._elements.lists[t].childNodes[s].dataset.optionValue);this._controls.picks[t]=this._controls.lists.list}return this._controls.picks},i.prototype._init=function(){this._controls={},this._controls.item={},this._controls.item.position={},this._controls.items=[],this._controls.lists={},this._controls.mouse={},this._controls.mouse.dist={},this._controls.mouse.down={},this._controls.picks=[],this._elements={}},i.prototype._mount=function(){this._picker(),this._options(),this._picks()},i.prototype._picker=function(){this._elements.picker=s.querySelector(this._identity),this._elements.picker?this._elements.picker.classList.contains("list-picker")?this._elements.lists=this._elements.picker.querySelectorAll(".list-picker-list"):console.error('<ListPicker> Setup Error: No container element with "list-picker" class was found'):console.error("<ListPicker> Setup Error: Cannot select element from given #ID")},i.prototype._options=function(){if(this._elements.options=this._elements.picker.querySelectorAll(".is-options-list"),"object"==typeof this._settings.list&&this._settings.list.length)if(this._elements.options.length)for(var e=0;e<this._elements.options.length;e++)if(e)this._elements.options[e].remove?this._elements.options[e].remove():this._elements.options[e].parentNode.removeChild(this._elements.options[e]);else{this._controls.lists.height=0,this._elements.options[e].innerHTML="";for(var i=0,o=0;i<this._settings.list.length;i++)"string"==typeof this._settings.list[i]&&this._settings.list[i].length?(this._elements.item=s.createElement("li"),this._elements.item.setAttribute("data-option-index",o),this._elements.item.setAttribute("data-option-value",this._settings.list[i]),this._elements.item.classList.add("list-picker-list-item"),"function"!=typeof this._settings.template?this._elements.item.textContent=o+1+". "+this._settings.list[i]:this._elements.item.innerHTML=this._settings.template(o,this._settings.list[i]),this._elements.options[e].appendChild(this._elements.item),o?(this._controls.lists.height+=this._elements.item.offsetHeight+this._settings.gap,this._elements.item.style.top=this._controls.items[o-1].top+this._controls.items[o-1].height+this._settings.gap+"px",this._elements.item.style.left="0px"):(this._controls.lists.height+=this._elements.item.offsetHeight,this._elements.item.style.top="0px",this._elements.item.style.left="0px"),this._controls.items.push({height:this._elements.item.offsetHeight,top:this._elements.item.offsetTop}),o++):console.error("<ListPicker> Create Error: Cannot create list item nº"+i+" because is empty or is not <String> type");this._elements.options[e].style.height=this._controls.lists.height+"px",this._settings.drag?(this._elements.options[e].addEventListener("mousedown",this._down.bind(this),!1),t.addEventListener("mousemove",this._drag.bind(this),!1),t.addEventListener("mouseup",this._drop.bind(this),!1)):(this._elements.options[e].addEventListener("click",this._click.bind(this),!1),this._elements.options[e].addEventListener("mouseenter",this._hover.bind(this),!1),this._elements.options[e].addEventListener("mouseleave",this._leave.bind(this),!1))}else console.error('<ListPicker> Setup Error: No <ul> element with "is-option-list" class was found to create OPTIONS list');else console.error("<ListPicker> Setup Error: No ARRAY of values was passed in constructor method")},i.prototype._picks=function(){if(this._elements.picks=this._elements.picker.querySelectorAll(".is-picks-list"),this._elements.picks.length)for(var s=0;s<this._elements.picks.length;s++)this._elements.picks[s].innerHTML="",this._elements.picks[s].style.height=this._controls.lists.height+"px",this._settings.drag?(this._elements.picks[s].addEventListener("mousedown",this._down.bind(this),!1),t.addEventListener("mousemove",this._drag.bind(this),!1),t.addEventListener("mouseup",this._drop.bind(this),!1)):(this._elements.picks[s].addEventListener("click",this._click.bind(this),!1),this._elements.picks[s].addEventListener("mouseenter",this._hover.bind(this),!1),this._elements.picks[s].addEventListener("mouseleave",this._leave.bind(this),!1));else console.error('<ListPicker> Setup Error: No <ul> element with "is-picks-list" class was found to create PICKS list')},i.prototype._click=function(t){if(this._elements.item=t.target,!this._elements.item.classList.contains("list-picker-list")){for(;!this._elements.item.classList.contains("list-picker-list-item");)this._elements.item=this._elements.item.parentNode;1===this._elements.picks.length?(this._elements.item.parentNode.classList.contains("is-options-list")?(this._elements.item.style.top=this._elements.item.offsetTop+"px",this._elements.item.style.left=this._elements.item.offsetWidth-this._elements.picks[0].offsetLeft-this._elements.item.offsetWidth+"px",this._elements.picks[0].appendChild(this._elements.item)):(this._elements.item.style.top=this._elements.item.offsetTop+"px",this._elements.item.style.left=this._elements.picks[0].offsetLeft+"px",this._elements.options[0].appendChild(this._elements.item)),setTimeout(this._reset.bind(this),1)):(this._controls.lists.current||(this._controls.lists.current=this._elements.item.parentNode),this._elements.item.parentNode===this._controls.lists.current&&(this._elements.item.classList.contains("is-selected")?(this._elements.item.style.zIndex=0,this._elements.item.classList.remove("is-selected")):(this._elements.item.style.zIndex=1+this._elements.item.dataset.optionIndex,this._elements.item.classList.add("is-selected")),this._controls.lists.items=this._controls.lists.current.querySelectorAll(".is-selected"),this._controls.lists.items.length||(this._controls.lists.current=null)))}if(this._elements.item.classList.contains("list-picker-list")||(this._elements.item=this._elements.item.parentNode),this._elements.item!==this._controls.lists.current&&(this._controls.lists.target=this._elements.item,this._controls.lists.current&&this._controls.lists.target!==this._controls.lists.current)){this._controls.lists.items=this._controls.lists.current.querySelectorAll(".is-selected");for(var s=0;s<this._controls.lists.items.length;s++)this._controls.lists.items[s].style.top=this._controls.lists.items[s].offsetTop+"px",this._controls.lists.items[s].style.left=this._controls.lists.items[s].offsetLeft-(this._controls.lists.target.offsetLeft-this._controls.lists.current.offsetLeft)+"px",this._controls.lists.items[s].style.zIndex=0,this._controls.lists.items[s].classList.remove("is-selected"),this._controls.lists.target.classList.remove("is-hover"),this._controls.lists.target.appendChild(this._controls.lists.items[s]);this._controls.lists.current=null,setTimeout(this._reset.bind(this),1)}},i.prototype._hover=function(t){this._controls.lists.current&&t.target!==this._controls.lists.current&&t.target.classList.add("is-hover")},i.prototype._leave=function(t){this._controls.lists.current&&t.target!==this._controls.lists.current&&t.target.classList.remove("is-hover")},i.prototype._down=function(t){if(!this._controls.drag&&(this._elements.item=t.target,!this._elements.item.classList.contains("list-picker-list"))){for(;!this._elements.item.classList.contains("list-picker-list-item");)this._elements.item=this._elements.item.parentNode;this._controls.drag=!0,this._controls.item.position.x=parseInt(this._elements.item.style.left),this._controls.item.position.y=parseInt(this._elements.item.style.top),this._controls.lists.current=this._elements.item.parentNode,this._controls.lists.target=null,this._controls.mouse.x=t.clientX-this._elements.picker.getBoundingClientRect().left,this._controls.mouse.y=t.clientY-this._elements.picker.getBoundingClientRect().top,this._controls.mouse.down.x=this._controls.mouse.x,this._controls.mouse.down.y=this._controls.mouse.y,this._controls.mouse.x>this._controls.lists.current.offsetLeft+this._controls.lists.current.offsetWidth/2?(this._elements.item.classList.add("is-dragging","by-right"),this._elements.item.classList.remove("by-left")):(this._elements.item.classList.add("is-dragging","by-left"),this._elements.item.classList.remove("by-right")),this._controls.lists.current.classList.add("is-hover")}},i.prototype._drag=function(t){if(this._controls.drag){this._controls.mouse.x=t.clientX-this._elements.picker.getBoundingClientRect().left,this._controls.mouse.y=t.clientY-this._elements.picker.getBoundingClientRect().top,this._controls.mouse.dist.x=this._controls.mouse.x-this._controls.mouse.down.x,this._controls.mouse.dist.y=this._controls.mouse.y-this._controls.mouse.down.y,this._elements.item.style.top=this._controls.item.position.y+this._controls.mouse.dist.y+"px",this._elements.item.style.left=this._controls.item.position.x+this._controls.mouse.dist.x+"px";for(var s=0;s<this._elements.lists.length;s++)this._controls.lists.x=this._elements.lists[s].offsetLeft+(this._elements.lists.length-1),this._controls.mouse.x>=this._controls.lists.x&&this._controls.mouse.x<=this._controls.lists.x+this._elements.lists[s].offsetWidth?(this._controls.lists.target=this._elements.lists[s],this._controls.lists.target.classList.add("is-hover")):this._elements.lists[s].classList.remove("is-hover")}},i.prototype._drop=function(t){this._controls.drag&&(this._controls.drag=!1,this._elements.item.classList.remove("is-dragging"),this._controls.lists.target?this._controls.lists.target===this._controls.lists.current?(this._elements.item.style.top=this._controls.item.position.y+"px",this._elements.item.style.left=this._controls.item.position.x+"px",this._controls.lists.target.classList.remove("is-hover")):(this._elements.item.style.top=this._elements.item.offsetTop+"px",this._elements.item.style.left=this._elements.item.offsetLeft-(this._controls.lists.target.offsetLeft-this._controls.lists.current.offsetLeft)+"px",this._controls.lists.target.classList.remove("is-hover"),this._controls.lists.target.appendChild(this._elements.item),setTimeout(this._reset.bind(this),1)):this._elements.item.parentNode.classList.contains("is-picks-list")?(this._elements.item.style.top=this._elements.item.offsetTop+"px",this._elements.item.style.left=this._controls.lists.current.offsetLeft+"px",this._elements.item.parentNode.classList.remove("is-hover"),this._elements.options[0].appendChild(this._elements.item),setTimeout(this._reset.bind(this),1)):this._elements.item.parentNode.classList.remove("is-hover"))},i.prototype._reset=function(){for(var t=0;t<this._elements.lists.length;t++)if(this._controls.item.position.top=0,this._settings.fixed)for(e=0;e<this._elements.lists[t].childNodes.length;e++)this._elements.lists[t].childNodes[e].style.left="0px";else if(this._settings.order)for(e=0;e<this._settings.list.length;e++)for(var s=0;s<this._elements.lists[t].childNodes.length;s++)e===parseInt(this._elements.lists[t].childNodes[s].dataset.optionIndex)&&(this._elements.lists[t].childNodes[s].style.top=this._controls.item.position.top+"px",this._elements.lists[t].childNodes[s].style.left="0px",this._controls.item.position.top+=this._elements.lists[t].childNodes[s].offsetHeight+this._settings.gap);else for(var e=0;e<this._elements.lists[t].childNodes.length;e++)this._elements.lists[t].childNodes[e].style.top=this._controls.item.position.top+"px",this._elements.lists[t].childNodes[e].style.left="0px",this._controls.item.position.top+=this._elements.lists[t].childNodes[e].offsetHeight+this._settings.gap},t.ListPicker=i}(window,document);